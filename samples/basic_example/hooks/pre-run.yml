---
- name: "Install required rpm packages"
  package:
    name: "{{ item }}"
    state: present
  loop:
    - curl
    - python3-openshift
    - python3-pyyaml
  become: true

- name: "Configure the namespace variable"
  set_fact:
    app_ns: "{{ dci_openshift_app_ns|default('myns') }}"
    dci_openshift_app_image: mirror.gcr.io/library/nginx:latest

- name: "basic_example : Mirror nginx image"
  include_role:
    name: mirror_images
  vars:
    images:
      - "{{ dci_openshift_app_image }}"
    authfile: "{{ pullsecret_tmp_file }}"
  when:
    - dci_disconnected | default(false) | bool
    - dci_local_registry | length
